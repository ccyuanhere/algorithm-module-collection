# 基于小波变换的频谱检测方法

## 一、算法概述
本算法是一种基于小波变换的增强型频谱检测方法，主要应用于认知无线电系统中的主用户检测。通过利用多维小波特征和支持向量机（SVM）分类器，能够显著提升频谱检测的性能。该算法会提取信号的多尺度特征，以此来有效区分空闲频谱和被占用频谱。

## 二、核心部分
### 2.1 多维特征提取
- **最大细节能量**：在小波分解后的各层细节系数中，计算并选取能量最大的值，用于反映信号的局部特征变化。
- **小波熵**：基于小波系数的能量分布计算熵值，体现信号的复杂度和无序程度。
- **能量比（细节/总能量）**：计算所有细节系数能量之和与总能量的比值，衡量细节信息在整个信号中的占比。
- **近似能量比**：近似系数能量与总能量的比值，反映信号的整体特征。

### 2.2 SVM分类器
- **使用径向基核函数（RBF）**：RBF核函数具有良好的非线性映射能力，能够处理复杂的分类问题。
- **自动学习特征决策边界**：SVM通过学习训练数据的特征，自动确定最优的决策边界，提高分类的准确性。
- **适应复杂信号环境**：能够在不同信噪比和信号调制类型的情况下，保持较好的性能。

### 2.3 特征可视化
- **生成3D特征分布图**：将提取的多维特征以三维散点图的形式展示，直观呈现不同类别信号的特征分布。
- **直观展示特征区分能力**：通过观察散点图，可以清晰地看到空闲信号和占用信号在特征空间中的分布差异，有助于评估特征的有效性。

## 三、性能指标
- **检测准确率（Accuracy）**：分类正确的样本数占总样本数的比例，反映整体分类的准确性。
- **精确率（Precision）**：预测为正类的样本中，实际为正类的比例，衡量模型预测正类的准确性。
- **召回率（Recall）**：实际为正类的样本中，被正确预测为正类的比例，体现模型对正类样本的识别能力。
- **F1分数（F1 - Score）**：精确率和召回率的调和平均数，综合考虑了两者的性能。
- **各特征统计量（均值/标准差）**：分析每个特征的均值和标准差，了解特征的分布情况。
- **处理时间**：包括整个算法的处理时间和平均每个样本的处理时间，评估算法的效率。

## 四、使用说明

### 4.1 环境准备
确保你已经安装了Python环境（建议Python 3.7及以上版本），并可以使用`pip`来安装依赖库。

### 4.2 安装依赖
在项目根目录下，使用以下命令安装所需的依赖库：
```bash
pip install -r requirements.txt
```
`requirements.txt`文件中包含了项目所需的主要库，具体如下：
- `numpy`：用于数值计算和数组操作。
- `pywavelets`：进行小波变换和特征提取。
- `scikit - learn`：提供SVM分类器和性能评估指标。
- `matplotlib`：用于数据可视化。
- `joblib`：用于模型的保存和加载。

### 4.3 生成示例数据
运行以下命令生成示例数据：
```bash
python make.py
```
此脚本会执行以下操作：
- 生成500个测试信号，其中空闲信号和占用信号各占50%。
- 信号的信噪比（SNR）在[-10, -5, 0] dB范围内随机选择。
- 保存生成的信号和标签到`data`目录下，分别为`example_input.npy`和`example_labels.npy`。
- 可视化示例信号，保存图像到`assets/signal_examples.png`。

### 4.4 运行算法
执行以下命令来运行算法：
```bash
python run.py
```
该脚本会完成以下任务：
1. **训练模型**：使用生成的示例数据训练SVM分类器，并将训练好的模型保存到`models/wtd_model.pkl`。
2. **评估模型**：使用相同的示例数据评估模型的性能，计算并打印各项性能指标。
3. **保存输出结果**：如果评估结果包含预测结果，将其保存到`data/example_output.npy`。
4. **可视化特征分布**：生成特征分布图，保存到`assets/feature_distribution.png`。

## 五、参数配置
可以通过编辑`config.json`文件来调整算法的参数，具体参数如下：
```json
{
    "wavelet": "db8",
    "level": 5,
    "model_type": "svm",
    "signal_length": "rand",
    "features": [
        "max_detail_energy",
        "entropy",
        "energy_ratio",
        "approx_energy_ratio"
    ]
}
```
- **`wavelet`**：小波基类型，默认值为`db8`，可以根据需要选择其他小波基。
- **`level`**：小波分解的层数，默认值为5，调整该参数会影响特征提取的效果。
- **`model_type`**：分类器类型，目前仅支持`svm`。
- **`signal_length`**：信号长度，默认值为`rand`，表示随机长度。
- **`features`**：要提取的特征列表，默认包含最大细节能量、小波熵、能量比和近似能量比。

## 六、可视化结果
算法运行完成后，会在`assets`目录下生成以下可视化结果：
- **`signal_examples.png`**：示例信号的可视化，展示空闲信号和占用信号的实部和虚部。
- **`feature_distribution.png`**：3D特征分布图，直观展示不同类别信号的特征分布。

通过观察这些可视化结果，可以更好地理解算法的工作原理和性能表现。